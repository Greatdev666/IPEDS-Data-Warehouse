{{ config(
    materialized='table'
) }}

WITH years AS (
    SELECT 2000 AS academic_year_id, DATE '1999-07-01' AS year_start_date, DATE '2000-06-30' AS year_end_date
    UNION ALL
    SELECT 2001, DATE '2000-07-01', DATE '2001-06-30'
    UNION ALL
    SELECT 2002, DATE '2001-07-01', DATE '2002-06-30'
    UNION ALL
    SELECT 2003, DATE '2002-07-01', DATE '2003-06-30'
    UNION ALL
    SELECT 2004, DATE '2003-07-01', DATE '2004-06-30'
    UNION ALL 
    SELECT 2005, DATE '2004-07-01', DATE '2005-06-30'
    UNION ALL
    SELECT 2006, DATE '2005-07-01', DATE '2006-06-30'
    UNION ALL
    SELECT 2007, DATE '2006-07-01', DATE '2007-06-30'
    UNION ALL
    SELECT 2008, DATE '2007-07-01', DATE '2008-06-30'
    UNION ALL
    SELECT 2009, DATE '2008-07-01', DATE '2009-06-30'
    UNION ALL
    SELECT 2010, DATE '2009-07-01', DATE '2010-06-30'
    UNION ALL
    SELECT 2011, DATE '2010-07-01', DATE '2011-06-30'
    UNION ALL
    SELECT 2012, DATE '2011-07-01', DATE '2012-06-30'
    UNION ALL
    SELECT 2013, DATE '2012-07-01', DATE '2013-06-30'
    UNION ALL
    SELECT 2014, DATE '2013-07-01', DATE '2014-06-30'
    UNION ALL
    SELECT 2015, DATE '2014-07-01', DATE '2015-06-30'
    UNION ALL
    SELECT 2016, DATE '2015-07-01', DATE '2016-06-30'
    UNION ALL
    SELECT 2017, DATE '2016-07-01', DATE '2017-06-30'
    UNION ALL
    SELECT 2018, DATE '2017-07-01', DATE '2018-06-30'
    UNION ALL
    SELECT 2019, DATE '2018-07-01', DATE '2019-06-30'
    UNION ALL
    SELECT 2020, DATE '2019-07-01', DATE '2020-06-30'
    UNION ALL
    SELECT 2021, DATE '2020-07-01', DATE '2021-06-30'
    UNION ALL
    SELECT 2022, DATE '2021-07-01', DATE '2022-06-30'
    UNION ALL
    SELECT 2023, DATE '2022-07-01', DATE '2023-06-30'
)

SELECT
    academic_year_id,
    year_start_date,
    year_end_date,
    CONCAT(academic_year_id, '-', RIGHT(CAST(academic_year_id+1 AS VARCHAR),2)) AS description
FROM years
